name: "Modbus Manager Aggregates"
version: 1
description: "Aggregate sensors across all Modbus Manager devices"
default_prefix: "aggregates"  # Default prefix for entity names
type: "aggregates"
firmware_version: "1.0.0"

# No regular sensors needed - this template only provides aggregates
sensors: []

# Aggregates configuration
aggregates:
  - name: "Total Grid Power"
    group: "PV_grid_power"
    method: "sum"
    unit_of_measurement: "W"
    device_class: "power"
    state_class: "measurement"
    icon: "mdi:transmission-tower"
    
  - name: "Total Grid Import Power"
    group: "PV_grid_import"
    method: "sum"
    unit_of_measurement: "W"
    device_class: "power"
    state_class: "measurement"
    icon: "mdi:transmission-tower-import"
    
  - name: "Total Grid Export Power"
    group: "PV_grid_export"
    method: "sum"
    unit_of_measurement: "W"
    device_class: "power"
    state_class: "measurement"
    icon: "mdi:transmission-tower-export"
    
  - name: "Total Battery Power"
    group: "PV_battery_power"
    method: "sum"
    unit_of_measurement: "W"
    device_class: "power"
    state_class: "measurement"
    icon: "mdi:battery"
    
  - name: "Total Solar Power"
    group: "PV_mppt_power"
    method: "sum"
    unit_of_measurement: "W"
    device_class: "power"
    state_class: "measurement"
    icon: "mdi:solar-power"
    
  - name: "Total DC Power"
    group: "PV_total_dc_power"
    method: "sum"
    unit_of_measurement: "W"
    device_class: "power"
    state_class: "measurement"
    icon: "mdi:lightning-bolt"
    
  - name: "Total Load Power"
    group: "PV_load_power"
    method: "sum"
    unit_of_measurement: "W"
    device_class: "power"
    state_class: "measurement"
    icon: "mdi:home-lightning-bolt"
    
  - name: "Average Efficiency"
    group: "PV_efficiency"
    method: "average"
    unit_of_measurement: "%"
    device_class: "power_factor"
    state_class: "measurement"
    icon: "mdi:gauge"
    
    
  - name: "Total Battery Charging Power"
    group: "PV_battery_charging"
    method: "sum"
    unit_of_measurement: "W"
    device_class: "power"
    state_class: "measurement"
    icon: "mdi:battery-plus"
    
  - name: "Total Battery Discharging Power"
    group: "PV_battery_discharging"
    method: "sum"
    unit_of_measurement: "W"
    device_class: "power"
    state_class: "measurement"
    icon: "mdi:battery-minus"
    
  - name: "Total Power Measurement"
    group: "PV_power_measurement"
    method: "sum"
    unit_of_measurement: "W"
    device_class: "power"
    state_class: "measurement"
    icon: "mdi:lightning-bolt"
    
  - name: "Total Power Balance"
    group: "PV_power_balance"
    method: "sum"
    unit_of_measurement: "W"
    device_class: "power"
    state_class: "measurement"
    icon: "mdi:scale-balance"
    
  - name: "Total Phase Power"
    group: "PV_phase_power"
    method: "sum"
    unit_of_measurement: "W"
    device_class: "power"
    state_class: "measurement"
    icon: "mdi:flash"
    
  - name: "Total Meter Power"
    group: "PV_meter_power"
    method: "sum"
    unit_of_measurement: "W"
    device_class: "power"
    state_class: "measurement"
    icon: "mdi:meter-electric"
    
  - name: "Device Count"
    group: "PV_device_count"
    method: "count"
    unit_of_measurement: ""
    device_class: null
    state_class: "measurement"
    icon: "mdi:counter"
    
  # EV Charger Aggregates
  - name: "Total EV Charging Power"
    group: "EV_charging_power"
    method: "sum"
    unit_of_measurement: "W"
    device_class: "power"
    state_class: "measurement"
    icon: "mdi:ev-station"
    
  - name: "Total EV Current"
    group: "EV_current_measurement"
    method: "sum"
    unit_of_measurement: "A"
    device_class: "current"
    state_class: "measurement"
    icon: "mdi:lightning-bolt"
    
  - name: "Total EV Max Current"
    group: "EV_max_current_setting"
    method: "sum"
    unit_of_measurement: "A"
    device_class: "current"
    state_class: "measurement"
    icon: "mdi:gauge"
    
  - name: "Total EV Max Charging Power"
    group: "EV_max_charging_power"
    method: "sum"
    unit_of_measurement: "W"
    device_class: "power"
    state_class: "measurement"
    icon: "mdi:ev-station"
    
  - name: "Average EV Charging Efficiency"
    group: "EV_efficiency"
    method: "average"
    unit_of_measurement: "%"
    device_class: "power_factor"
    state_class: "measurement"
    icon: "mdi:gauge"
    
  - name: "Active EV Chargers"
    group: "EV_charging_status"
    method: "count"
    unit_of_measurement: ""
    device_class: null
    state_class: "measurement"
    icon: "mdi:ev-station"
